

/* web/openwebrx/audio.min.js */
var audio_stat_output_bufs,audio_stat_last_time,audio_running,audio_started,audio_last_output_offset,audio_mode_iq,audio_compression,audio_stat_input_epoch,audio_prepared_buffers,audio_prepared_buffers2,audio_prepared_seq,audio_prepared_flags,audio_prepared_smeter,audio_buffering,audio_convolver_running,audio_meas_dly,audio_meas_dly_start,resample_new,resample_old,resample_init1,resample_init2,resample_input_buffer,resample_input_available,resample_input_processed,resample_last_taps_delay,resample_output_buffer,resample_output_buffer2,resample_output_size,resample_taps,resample_taps_length,resample_last,resample_last2,audio_ext_adc_ovfl,audio_need_stats_reset,audio_change_LPF_latch,audio_change_freq_latch,audio_change_sq_UI_latch,audio_last_sq,audio_gain,comp_lpf_freq,comp_lpf_taps,comp_lpf_taps_length,audio_buffer_size,audio_buffer_min_length_sec,audio_buffer_max_length_sec,audio_data,audio_last_output_buffer,audio_last_output_buffer2,audio_silence_buffer,audio_stats_interval,audio_periodic_interval,audio_context,audio_output_rate,audio_last_is_local,audio_last_compression,audio_input_rate,audio_interpolation,audio_decimation,audio_resample_ratio,audio_transition_bw,audio_min_nbuf,audio_max_nbuf,audio_stat_output_epoch,audio_channels,audio_source,audio_watchdog,audio_change_LPF_delayed,audio_disconnected,audio_convolver,audio={d:!1,last_flags:0,trim_bufs:!1,lo_cut:0,hi_cut:0},audio_periodic_interval_ms=1e3,audio_flags={SND_FLAG_LPF:1,SND_FLAG_ADC_OVFL:2,SND_FLAG_NEW_FREQ:4,SND_FLAG_MODE_IQ:8,SND_FLAG_COMPRESSED:16,SND_FLAG_RESTART:32,SND_FLAG_SQUELCH_UI:64,SND_FLAG_LITTLE_ENDIAN:128},audio_ext_sequence=0,audio_meas_dly_ena=0,audio_initial_connect=!1,audio_watchdog_restart=!1,audio_stat_input_size=0,audio_stat_total_input_size=0,audio_reconnect=0,audio_silence_count=0,audio_restart_count=0,audio_underrun_errors=0,audio_overrun_errors=0,audio_last_underruns=0,audio_last_reconnect=0,audio_last_restart_count=0,resample_new_default=!1,audio_adpcm={index:0,previousValue:0},audio_panner=null,audio_instance=0,audio_camping=0,audio_init_disconnect=0,audio_firefox_watchdog=0;function audio_camp(a,e,_,o){audio_camping=a?0:1,audio_init_disconnect=a,audio_init(e,_,o),audio_ext_sequence=0,audio_meas_dly_ena=0,audio_initial_connect=!1,audio_watchdog_restart=!1}function audio_reset(){audio.trim_bufs=!0}function audio_init(a,e,_){if(audio_running=!1,kiwi_clearInterval(audio_periodic_interval),console.log("--------------------------"),audio.d&&console.log("AUDIO audio_init CALLED audio_init_disconnect="+audio_init_disconnect+" is_local="+a+" less_buffering="+e+" compression="+_),e=!1,audio.d&&console.log("AUDIO audio_init LAST audio_last_is_local="+audio_last_is_local+" audio_last_compression="+audio_last_compression),null==a&&(a=audio_last_is_local),audio_last_is_local=a,null==_&&(_=audio_last_compression),audio_last_compression=_,console.log("AUDIO audio_init FINAL is_local="+a+" less_buffering="+e+" compression="+_),(audio_init_disconnect||null!=audio_source)&&(audio.d&&console.log("AUDIO audio_init audio_disconnect"),audio_disconnect()),audio_started=!1,audio_last_output_offset=0,audio_mode_iq=!1,audio_compression=!!_,audio_stat_input_epoch=-1,audio_prepared_buffers=Array(),audio_prepared_buffers2=Array(),audio_prepared_seq=Array(),audio_prepared_flags=Array(),audio_prepared_smeter=Array(),audio_buffering=!1,audio_convolver_running=!1,audio_meas_dly=0,audio_meas_dly_start=0,resample_new=!kiwi_isMobile()&&resample_new_default,resample_old=!resample_new,resample_init1=!1,resample_init2=!1,resample_input_buffer=[],resample_input_available=0,resample_input_processed=0,resample_last_taps_delay=0,resample_output_buffer=[],resample_output_buffer2=[],resample_taps=[],resample_last=0,resample_last2=0,comp_lpf_freq=0,comp_lpf_taps=[],comp_lpf_taps_length=255,audio_adpcm.index=0,audio_adpcm.previousValue=0,audio_ext_adc_ovfl=!1,audio_need_stats_reset=!0,audio_change_LPF_latch=!1,audio_change_freq_latch=!1,audio_change_sq_UI_latch=!1,audio_last_sq=void 0,audio_firefox_watchdog=0,kiwi_clearInterval(audio_stats_interval),audio_init_disconnect)return audio.d&&console.log("AUDIO audio_init DISCONNECT"),audio_init_disconnect=0,!1;var o,i=0,u=kiwi_url_param("abuf",null,null),t=0;if(null!=u){var d=u.split(",");if(t=parseFloat(d[0]),!isNaN(t)&&t>=.25&&t<=5){console.log("AUDIO override abuf="+u);var r=3*t;if(d.length>=2){var s=parseFloat(d[1]);!isNaN(s)&&s>=.25&&s<=5&&s>t&&(r=s)}else r=3*t;audio_buffer_min_length_sec=t,audio_buffer_max_length_sec=r,audio_buffer_size=8192,i=9,o="abuf="}else t=0}0==t&&(2==(i=e?a?2:1:0)?(audio_buffer_size=8192,audio_buffer_min_length_sec=.37,audio_buffer_max_length_sec=2,o="less buf, local"):1==i?(audio_buffer_size=8192,audio_buffer_min_length_sec=.74,audio_buffer_max_length_sec=3,o="less buf, remote"):0==i&&(audio_buffer_size=8192,audio_buffer_min_length_sec=.85,audio_buffer_max_length_sec=3.4,o="more buf")),audio_data=new Int16Array(audio_buffer_size),audio_last_output_buffer=new Float32Array(audio_buffer_size),audio_last_output_buffer2=new Float32Array(audio_buffer_size),audio_silence_buffer=new Float32Array(audio_buffer_size),console.log("AUDIO buffer_size="+audio_buffer_size+" buffering_scheme: "+o),audio_stats_interval=setInterval(audio_stats,1e3);try{window.AudioContext=window.AudioContext||window.webkitAudioContext,(audio_context=new AudioContext).sampleRate=44100,audio_output_rate=audio_context.sampleRate;try{audio_panner=audio_context.createStereoPanner(),audio_panner_ui_init()}catch(a){audio_panner=null}kiwi_isSmartTV()&&(audio_gain=audio_context.createGain())}catch(a){return kiwi_serious_error("Your browser does not support Web Audio API, which is required for OpenWebRX to run. Please use an HTML5 compatible browser."),audio_context=null,audio_output_rate=0,!0}return setTimeout(function(a){snd_send("SET little-endian")},1e4,++audio_instance),audio_running=!0,!1}function audio_rate(a){if(0==(audio_input_rate=a))snd_send("SET x-DEBUG user's browser gave zero audio_input_rate?"),kiwi_serious_error("Audio initialization problem.");else if(0==audio_output_rate)snd_send("SET x-DEBUG user's browser doesn't support WebAudio"),snd_send("SET x-DEBUG "+navigator.userAgent),kiwi_serious_error("Browser doesn't support WebAudio:<br>"+navigator.userAgent+"<br><br>Please update to the latest version of your browser.");else if(resample_old)audio_interpolation=audio_output_rate/audio_input_rate,audio_decimation=1;else if(0==(audio_interpolation=0)){var e,_;for(e=2;e<=1024;e++){var o=a*e/audio_output_rate;if(_=Math.floor(o),Math.abs(o-_)<1e-5)break}e>1024?(snd_send("SET UAR in="+a+" out="+audio_output_rate),kiwi_serious_error("Your system uses an audio output rate of "+audio_output_rate+" sps which we do not support.")):(audio_interpolation=e,audio_decimation=_)}0!=audio_interpolation?(audio_transition_bw=.001,audio_resample_ratio=audio_output_rate/audio_input_rate,snd_send("SET AR OK in="+a+" out="+audio_output_rate)):audio_resample_ratio=1,audio_min_nbuf=Math.ceil(audio_buffer_min_length_sec*audio_output_rate/audio_buffer_size),audio_max_nbuf=Math.ceil(audio_buffer_max_length_sec*audio_output_rate/audio_buffer_size),console.log("AUDIO audio_input_rate="+audio_input_rate+" audio_output_rate="+audio_output_rate),console.log("AUDIO min_length_sec="+audio_buffer_min_length_sec+"("+audio_min_nbuf+" bufs) max_length_sec="+audio_buffer_max_length_sec+"("+audio_max_nbuf+" bufs)")}function audio_start(){if(audio.d&&console.log("AUDIO audio_start"),null!=audio_context){audio_started=!0,audio_connect(0),audio_periodic_interval=setInterval(audio_periodic,audio_periodic_interval_ms);try{demodulator_analog_replace(init_mode)}catch(a){snd_send("SET x-DEBUG audio_start.demodulator_analog_replace: catch: "+a.toString())}}}function audio_disconnect(){audio.d&&console.log("AUDIO audio_disconnect"),audio_source&&(audio_disconnected=!0,audio_source.disconnect(),audio_source.onaudioprocess=null,audio_source=null),audio_convolver_running&&(audio_convolver.disconnect(),audio_convolver_running=!1),audio_watchdog&&(audio_watchdog.disconnect(),audio_watchdog.onaudioprocess=null,audio_watchdog=null),audio_panner&&audio_panner.disconnect()}function audio_connect_destination(a){kiwi_isSmartTV()&&(audio_gain.gain.value=.3,a.connect(audio_gain),a=audio_gain),audio_panner?(a.connect(audio_panner),audio_panner.connect(audio_context.destination)):a.connect(audio_context.destination)}function audio_set_pan(a){if(audio_panner)try{audio_panner.pan.value=a}catch(a){}}function audio_connect(a){null!=audio_context&&(!audio_initial_connect&&a||(a||(audio_initial_connect=!0),a&&(audio_disconnect(),resample_init1=resample_init2=!1,audio_reconnect++,kiwi_log("AUDIO reconnect BUFFERING true"),audio_buffering=!0),audio_stat_output_epoch=-1,audio_change_LPF_delayed=!1,(audio_source=audio_context.createScriptProcessor(audio_buffer_size,0,audio_channels)).onaudioprocess=audio_onprocess,audio_disconnected=!1,audio_convolver_running?(audio_source.connect(audio_convolver),audio_connect_destination(audio_convolver)):audio_connect_destination(audio_source),kiwi_isFirefox()&&((audio_watchdog=audio_context.createScriptProcessor(audio_buffer_size,audio_channels,0)).onaudioprocess=audio_watchdog_process,audio_convolver_running?audio_convolver.connect(audio_watchdog):audio_source.connect(audio_watchdog))))}function audio_watchdog_process(a){if(kiwi.muted||audio_buffering)audio_silence_count=0;else{var e=a.inputBuffer.getChannelData(0),_=0==e[0];kiwi_gc_snd&&(e=null),(audio_silence_count=_?audio_silence_count+1:0)>16&&(audio_connect(1),audio_silence_count=0,audio_restart_count++,add_problem("FF silence"),kiwi_log("AUDIO FF SILENCE"))}}function audio_onprocess(a){if(audio_firefox_watchdog++,!audio_disconnected){if(-1==audio_stat_output_epoch&&(audio_stat_output_epoch=(new Date).getTime(),audio_stat_output_bufs=0),audio_stat_output_bufs++,audio_started&&0==audio_prepared_buffers.length&&(audio_underrun_errors++,audio_buffering=!0),!audio_started||audio_buffering)return audio_need_stats_reset=!0,a.outputBuffer.copyToChannel(audio_silence_buffer,0),void(2==audio_channels&&a.outputBuffer.copyToChannel(audio_silence_buffer,1));a.outputBuffer.copyToChannel(audio_prepared_buffers.shift(),0),2==audio_channels&&a.outputBuffer.copyToChannel(audio_prepared_buffers2.shift(),1),audio_ext_sequence=audio_prepared_seq.shift(),audio_change_LPF_delayed&&(audio_recompute_LPF(0),audio_change_LPF_delayed=!1),owrx.sMeter_dBm_biased=audio_prepared_smeter.shift()/10,owrx.sMeter_dBm=owrx.sMeter_dBm_biased-SMETER_BIAS;var e=audio_prepared_flags.shift();audio_ext_adc_ovfl=!!(e&audio_flags.SND_FLAG_ADC_OVFL),e&audio_flags.SND_FLAG_LPF&&(audio_change_LPF_delayed=!0);var _=!!(e&audio_flags.SND_FLAG_SQUELCH_UI);_!=audio_last_sq&&isDefined(squelch_action)&&(setTimeout(function(a){squelch_action(a)},1,_),audio_last_sq=_),audio_meas_dly_ena&&audio_meas_dly_start&&e&audio_flags.SND_FLAG_NEW_FREQ&&(audio_meas_dly=(new Date).getTime()-audio_meas_dly_start,kiwi_log("AUDIO dly="+audio_meas_dly),audio_meas_dly_start=0)}}var audio_watchdog_restart_cnt=0;function audio_periodic(){audio_started&&audio_prepared_buffers.length&&0==audio_firefox_watchdog&&kiwi_isFirefox()&&!cfg.disable_recent_changes&&(add_problem("FF watchdog"),console.log("AUDIO FF WATCHDOG Q"+audio_prepared_buffers.length+" WD="+audio_firefox_watchdog+" ============================================"),audio_init(0,null,!1,null),audio_initial_connect=!0,audio_watchdog_restart=!0,snd_send("SET reinit"));for(var a=!1;audio_prepared_buffers.length>audio_max_nbuf;)a=!0,audio_prepared_buffers.shift(),2==audio_channels&&audio_prepared_buffers2.shift(),audio_prepared_seq.shift(),audio_prepared_flags.shift(),audio_prepared_smeter.shift();a&&(add_problem("audio overrun"),audio_overrun_errors++),audio_last_underruns!=audio_underrun_errors&&(add_problem("audio underrun"),snd_send("SET underrun="+audio_underrun_errors),audio_last_underruns=audio_underrun_errors)}function audio_adpcm_state(a,e){audio_adpcm.index=a,audio_adpcm.previousValue=e,audio_camping=2}function audio_recv(a){if(audio_running){var e=new Uint8Array(a,0,8),_=e[3],o=e[7]<<24|e[6]<<16|e[5]<<8|e[4];if(!(1==audio_camping&&_&audio_flags.SND_FLAG_COMPRESSED)){var i,u=new Uint8Array(a,8,2),t=u[0]<<8|u[1],d=_&audio_flags.SND_FLAG_MODE_IQ,r=new DataView(a,d?20:10),s=r.byteLength;if(audio_watchdog_restart){if(!(_&audio_flags.SND_FLAG_RESTART))return;audio_watchdog_restart=!1,audio_prepared_buffers=[],audio_prepared_buffers2=[],audio_prepared_seq=[],audio_prepared_flags=[],audio_prepared_smeter=[],audio_mode_iq?resample_old=!(resample_new=!1):(audio_adpcm.index=audio_adpcm.previousValue=0,resample_new=!kiwi_isMobile()&&resample_new_default,resample_old=!resample_new),audio_connect(1)}else if(d)audio_mode_iq||(audio_prepared_buffers=[],audio_prepared_buffers2=[],audio_prepared_seq=[],audio_prepared_flags=[],audio_prepared_smeter=[],resample_old=!(resample_new=!1),audio_mode_iq=!0,audio_channels=2,audio.d&&console.log("AUDIO !IQ -> IQ transition"),audio_connect(1)),audio_last_compression=audio_compression=!1,audio_mode_iq=!0;else{var n=!!(_&audio_flags.SND_FLAG_COMPRESSED);(audio_mode_iq||audio_compression!=n)&&(audio_prepared_buffers=[],audio_prepared_buffers2=[],audio_prepared_seq=[],audio_prepared_flags=[],audio_prepared_smeter=[],audio_adpcm.index=audio_adpcm.previousValue=0,resample_new=!kiwi_isMobile()&&resample_new_default,resample_old=!resample_new,audio.d&&(audio_mode_iq?console.log("AUDIO IQ -> !IQ transition, compressed="+n):console.log("AUDIO !IQ, compression change="+(audio_compression!=n)+" compressed="+n)),audio_mode_iq=!1,audio_channels=1,audio_last_compression=audio_compression=n,audio_connect(1)),audio_last_compression=audio_compression=n,audio_mode_iq=!1}if(audio_channels=audio_mode_iq?2:1,audio_compression)audio.d&&console.log("AC Q"+audio_prepared_buffers.length+" #"+audio_channels),decode_ima_adpcm_e8_i16(r,audio_data,s,audio_adpcm),i=2*s;else for(audio.d&&(d?console.log("ANC IQ Q"+audio_prepared_buffers.length+"/"+audio_prepared_buffers2.length+" #"+audio_channels):console.log("ANC Q"+audio_prepared_buffers.length+" #"+audio_channels)),i=s/2,p=0;p<i;p++)audio_data[p]=r.getInt16(2*p,!!(_&audio_flags.SND_FLAG_LITTLE_ENDIAN));if(audio_prepare(audio_data,i,o,_,t),!audio_started)audio_prepared_buffers.length>audio_min_nbuf&&audio_start();if(audio_need_stats_reset&&audio_stats_reset(),audio_stat_input_size+=i,audio_stat_total_input_size+=i,extint_audio_data(audio_data,i),wf.audioFFT_active&&wf_audio_FFT(audio_data,i),window.recording&&0==audio_last_sq){for(var l=audio_mode_iq?1024:n?2048:512,p=0;p<l;++p)window.recording_meta.data.setInt16(window.recording_meta.offset,audio_data[p],!0),window.recording_meta.offset+=2;window.recording_meta.total_size+=2*l,65536==window.recording_meta.offset&&(window.recording_meta.buffers.push(new ArrayBuffer(65536)),window.recording_meta.data=new DataView(window.recording_meta.buffers[window.recording_meta.buffers.length-1]),window.recording_meta.offset=0)}}}}var audio_push_ct=0;function audio_prepare(a,e,_,o,i){var u,t,d,r=resample_new&&audio_compression&&comp_lpf_taps_length,s=function(){audio_prepared_buffers.push(audio_last_output_buffer),2==audio_channels&&audio_prepared_buffers2.push(audio_last_output_buffer2),audio_prepared_seq.push(_),audio_change_LPF_latch&&(audio_change_LPF_latch=!1,o|=audio_flags.SND_FLAG_LPF),audio_change_freq_latch&&(audio_change_freq_latch=!1,o|=audio_flags.SND_FLAG_NEW_FREQ),audio_change_sq_UI_latch&&(audio_change_sq_UI_latch=!1,o|=audio_flags.SND_FLAG_SQUELCH_UI),audio_prepared_flags.push(o),audio_prepared_smeter.push(i),audio_last_output_offset=0,audio_last_output_buffer=new Float32Array(audio_buffer_size),2==audio_channels&&(audio_last_output_buffer2=new Float32Array(audio_buffer_size))},n=function(a,e,_,o,i){var u;for(u=0;u<i;u++)a[e+u]=_[o+u]};if(0!=e){if(1!=audio_resample_ratio){var l,p;if(resample_init1||((resample_taps_length=Math.round(4/audio_transition_bw))%2==0&&resample_taps_length++,rational_resampler_get_lowpass_f(resample_taps,resample_taps_length,audio_interpolation,audio_decimation),resample_init1=!0),!resample_init2&&resample_init1&&(r||resample_old)&&null!=audio_source)audio_recompute_LPF(1),l=comp_lpf_taps,p=comp_lpf_taps_length,(audio_convolver=audio_context.createConvolver()).normalize=!1,audio_reload_convolver_buffer(l,p),audio.d&&console.log("AUDIO splice in convolver"),audio_source.disconnect(),audio_source.connect(audio_convolver),audio_connect_destination(audio_convolver),kiwi_isFirefox()&&audio_convolver.connect(audio_watchdog),audio_convolver_running=!0,resample_init2=!0;if(resample_old)if(2==audio_channels){resample_output_size=Math.round(e/2*audio_resample_ratio);var f,c=1/audio_resample_ratio,m=0,g=0;for(A=0;A<resample_output_size;A++)h=a[2*m],b=resample_last,resample_output_buffer[A]=(h-b)*g+b,f=a[2*m+1],b=resample_last2,resample_output_buffer2[A]=(f-b)*g+b,(g+=c)>=1&&(g-=1,resample_last=h,resample_last2=f,m++);resample_last=h,resample_last2=f}else{resample_output_size=Math.round(e*audio_resample_ratio);var h,b;c=1/audio_resample_ratio,m=0,g=0;for(A=0;A<resample_output_size;A++)h=a[m],b=resample_last,resample_output_buffer[A]=(h-b)*g+b,(g+=c)>=1&&(g-=1,resample_last=h,m++);resample_last=h}else{if(0!=resample_input_processed){var w=resample_input_available-resample_input_processed;n(resample_input_buffer,0,resample_input_buffer,resample_input_processed,w),resample_input_available=w,resample_input_processed=0}n(resample_input_buffer,resample_input_available,a,0,e),resample_input_available+=e,2==audio_channels?rational_resampler_cc(resample_input_buffer,resample_output_buffer,resample_output_buffer2,resample_input_available,audio_interpolation,audio_decimation,resample_taps,resample_taps_length,resample_last_taps_delay):rational_resampler_ff(resample_input_buffer,resample_output_buffer,resample_input_available,audio_interpolation,audio_decimation,resample_taps,resample_taps_length,resample_last_taps_delay)}u=resample_output_buffer,t=resample_output_buffer2,d=resample_output_size}else u=a,d=e;if(o&audio_flags.SND_FLAG_LPF&&(audio_change_LPF_latch=!0),o&audio_flags.SND_FLAG_NEW_FREQ||audio.trim_bufs){audio_change_freq_latch=!0,audio.trim_bufs=!1;audio_prepared_buffers.length;for(var v=audio_min_nbuf;audio_prepared_buffers.length>v;)audio_prepared_buffers.pop(),2==audio_channels&&audio_prepared_buffers2.pop(),audio_prepared_seq.pop(),audio_prepared_flags.pop(),audio_prepared_smeter.pop()}if(o&audio_flags.SND_FLAG_SQUELCH_UI&&(audio_change_sq_UI_latch=!0),audio_last_output_offset+d<=audio_buffer_size){if(2==audio_channels)for(var A=0;A<d;A++)audio_last_output_buffer[A+audio_last_output_offset]=u[A]/32768*kiwi.volume_f,audio_last_output_buffer2[A+audio_last_output_offset]=t[A]/32768*kiwi.volume_f;else for(A=0;A<d;A++)audio_last_output_buffer[A+audio_last_output_offset]=u[A]/32768*kiwi.volume_f;(audio_last_output_offset+=d)==audio_buffer_size&&s()}else{var F=audio_buffer_size-audio_last_output_offset,D=d-F;if(2==audio_channels)for(A=0;A<audio_buffer_size-audio_last_output_offset;A++)audio_last_output_buffer[A+audio_last_output_offset]=u[A]/32768*kiwi.volume_f,audio_last_output_buffer2[A+audio_last_output_offset]=t[A]/32768*kiwi.volume_f;else for(A=0;A<audio_buffer_size-audio_last_output_offset;A++)audio_last_output_buffer[A+audio_last_output_offset]=u[A]/32768*kiwi.volume_f;s();do{for(A=0;A<D;A++){if(A==audio_buffer_size){s();break}audio_last_output_buffer[A]=u[A+F]/32768*kiwi.volume_f,2==audio_channels&&(audio_last_output_buffer2[A]=t[A+F]/32768*kiwi.volume_f)}D-=A,F+=A}while(D);audio_last_output_offset+=A}if(audio_buffering)audio_prepared_buffers.length>audio_min_nbuf&&(audio_buffering=!1)}}try{AudioBuffer.prototype.copyToChannel||(AudioBuffer.prototype.copyToChannel=function(a,e){for(var _=this.getChannelData(e),o=0;o<a.length;o++)_[o]=a[o]})}catch(a){console.log("CATCH: AudioBuffer.prototype.copyToChannel")}function audio_stats_reset(){audio_stat_input_epoch=(new Date).getTime(),audio_stat_last_time=audio_stat_input_epoch,audio_stat_input_size=audio_stat_total_input_size=0,audio_need_stats_reset=!1}function audio_stats(){if(-1!=audio_stat_input_epoch&&-1!=audio_stat_output_epoch){var a=(new Date).getTime(),e=(a-audio_stat_last_time)/1e3;audio_stat_last_time=a;var _=audio_stat_total_input_size/((a-audio_stat_input_epoch)/1e3),o=audio_stat_output_bufs*audio_buffer_size/((a-audio_stat_output_epoch)/1e3),i="Audio: network "+(audio_stat_input_size/e).toFixed(0)+" sps ("+_.toFixed(0)+" avg), output "+o.toFixed(0)+" sps";i+=", Qlen "+audio_prepared_buffers.length,audio_underrun_errors&&(i+=", underruns "+audio_underrun_errors.toString()),audio_restart_count&&(i+=", restart "+audio_restart_count.toString()),w3_innerHTML("id-msg-audio",i),audio.d&&console.log(i),isNaN(o)&&(o=0),w3_innerHTML("id-status-audio",w3_text(optbar_prefix_color,"WF"),w3_text("",kiwi.wf_fps.toFixed(0)+" fps"),w3_text(optbar_prefix_color,"Audio"),w3_text("",(o/1e3).toFixed(1)+"k, Qlen "+audio_prepared_buffers.length)),audio_stat_input_size=0}}function audio_recompute_LPF(a,e,_){isDefined(e)&&isDefined(_)&&(audio.lo_cut=Math.abs(e),audio.hi_cut=Math.abs(_)),audio_camping?(e=audio.lo_cut,_=audio.hi_cut):isDefined(demodulators[0])?(_=Math.abs(demodulators[0].high_cut),isNaN(_)&&console.log(demodulators[0]),e=Math.abs(demodulators[0].low_cut)):(e=0,_=4e3);var o=Math.max(_,e);(a||o!=comp_lpf_freq)&&(firdes_lowpass_f(comp_lpf_taps,comp_lpf_taps_length,o/audio_output_rate),comp_lpf_freq=o,audio_convolver_running&&audio_reload_convolver_buffer(comp_lpf_taps,comp_lpf_taps_length))}function audio_reload_convolver_buffer(a,e){var _=audio_context.createBuffer(2,e,audio_output_rate),o=_.getChannelData(0);o.set(a),(o=_.getChannelData(1)).set(a),audio_convolver.buffer=_}function rational_resampler_ff(a,e,_,o,i,u,t,d){var r,s,n,l,p=Math.round(_*o/i);for(s=0;s<p&&(n=Math.floor((s*i+o-1-d)/o),l=Math.floor((d+n*o-s*i)%o),!(n+t/o+1>_));s++){var f=Math.floor((t-l)/o),c=0;for(r=0;r<f;r++)c+=a[n+r]*u[l+r*o];e[s]=c*o}resample_input_processed=n,resample_output_size=s,resample_last_taps_delay=l}function rational_resampler_cc(a,e,_,o,i,u,t,d,r){console.log("WARNING rational_resampler_cc() not working yet!")}function rational_resampler_get_lowpass_f(a,e,_,o){var i=1/_,u=1/o;firdes_lowpass_f(a,e,(i<u?i:u)/2)}function firdes_lowpass_f(a,e,_){var o,i=Math.floor(e/2);for(a[i]=2*Math.PI*_*firdes_wkernel_hamming(0),o=1;o<=i;o++)a[i-o]=a[i+o]=Math.sin(2*Math.PI*_*o)/o*firdes_wkernel_hamming(o/i);var u=0;for(o=0;o<e;o++)u+=a[o];for(o=0;o<e;o++)a[o]/=u}function firdes_wkernel_hamming(a){return a=.5+a/2,.54-.46*Math.cos(2*Math.PI*a)}


