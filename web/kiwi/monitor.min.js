

/* web/kiwi/monitor.min.js */
var monitor={init:!1};function kiwi_queue_cb(){kiwi.queued^=1,w3_innerHTML("id-queue-button",kiwi.queued?"Exit queue":"Enter queue"),kiwi.queued||w3_innerHTML("id-queue-pos",""),msg_send("SET MON_QSET="+(kiwi.queued?1:0))}function kiwi_monitor(){console.log("n_camp="+cfg.n_camp);var e=cfg.n_camp?"To camp (listen) to the audio of an existing connection <br>click on one of the channel links below.":"No audio camping allowed on this Kiwi.",i=w3_div("",w3_text("w3-text-black","All Kiwi channels busy. Click button to wait in queue for an available channel."),w3_inline("w3-margin-L-8 w3-margin-T-4/w3-margin-right w3-valign",w3_button("id-queue-button w3-medium w3-padding-smaller w3-green","Enter queue","kiwi_queue_cb"),w3_text("id-queue-pos w3-text-black"),w3_button("id-queue-button w3-medium w3-padding-smaller w3-yellow","Reload page","kiwi_queue_reload_cb")),w3_text("id-queue-status w3-margin-T-4 w3-text-black",""),w3_div("id-camp-container",w3_hr("w3-margin-16"),w3_text("w3-margin-T-4 w3-text-black w3-show-block",e),w3_text("id-camp-status w3-margin-T-4 w3-text-black","")),w3_hr("w3-margin-16"),w3_div("id-users-list w3-margin-T-10"));kiwi_show_msg(i),kiwi.unmuted_color="mediumSeaGreen",users_init({monitor:1}),pwd_prot=chan_no_pwd_true?rx_chans-chan_no_pwd_true:0,console.log("rx_chans="+rx_chans+" chan_no_pwd_true="+chan_no_pwd_true+" pwd_prot="+pwd_prot);var n=plural(pwd_prot," channel"),t=1==pwd_prot?"is":"are";pwd_prot?(i="<br>Note that "+pwd_prot+n+" on this Kiwi "+t+" password protected. <br>This is why you may see empty channels you cannot access.",w3_innerHTML("id-queue-status",i)):w3_innerHTML("id-queue-status",""),setInterval(function(){msg_send("SET keepalive"),kiwi.queued&&msg_send("SET MON_QPOS")},2500),ws_any().msg_cb=function(e){var i=e[1]?e[1].split(","):null;switch(e[0]){case"qpos":var n=i[0],t=i[1];+i[2]&&kiwi_queue_reload_cb();var a="";kiwi.queued&&(a+="You are "+n+" of "+t+" in queue."),w3_innerHTML("id-queue-pos",a);break;case"camp":var o=+i[0],_=+i[1];o?(monitor.init||(check_suspended_audio_state(),monitor.init=!0),a=w3_div("",w3_inline("w3-margin-T-4/w3-margin-right w3-valign",w3_text("id-queue-pos w3-text-black","Camping on RX"+_),w3_button("w3-medium w3-padding-smaller w3-red","Stop","kiwi_camp_stop_cb"),w3_slider("w3-margin-L-16/w3-label-inline w3-label-not-bold/","Volume","kiwi.volume",kiwi.volume,0,200,1,"setvolume"),w3_div('|background-color: #e0e0e0; padding:2px; border-radius:8px|title="mute"',w3_div("id-mute-no fa-stack|width:28px; color:"+kiwi.unmuted_color,w3_icon("","fa-volume-up fa-stack-2x fa-nudge-up",24,"inherit","toggle_or_set_mute")),w3_div("id-mute-yes fa-stack w3-hide|width:28px;color:magenta;",w3_icon("","fa-volume-off fa-stack-2x fa-nudge-left fa-nudge-up",24,"","toggle_or_set_mute"),w3_icon("","fa-times fa-right",12,"","toggle_or_set_mute"))))+w3_div("id-control-smeter w3-margin-T-4"))):(a="Too many campers on channel RX"+_,_=-1),kiwi_camp_update(_,a),-1!=_&&smeter_init(!0),toggle_or_set_mute(0);break;case"camp_stop":kiwi_camp_stop_cb();break;default:owrx_msg_cb(e)}}}function kiwi_queue_reload_cb(){var e=kiwi_remove_search_param(window.location.href,"camp");window.location.href=e}function kiwi_camp_update(e,i){w3_innerHTML("id-camp-status",i);for(var n=0;n<rx_chans;n++){var t=w3_el("id-user-"+n);w3_remove(t,"w3-green"),n==e&&w3_add(t,"w3-green")}}function camp(e,i,n,t){console.log("camp ch"+e),cfg.n_camp&&msg_send("SET MON_CAMP="+e)}function kiwi_camp_stop_cb(){console.log("camp STOP"),kiwi_camp_update(-1,""),msg_send("SET MON_CAMP=-1")}


