

/* web/kiwi/kiwi.min.js */
var kiwi={is_local:[],loaded_files:{},WSPR_rgrid:"",GPS_fixes:0,wf_fps:0,inactivity_panel:!1,is_multi_core:0,volume:50,volume_f:0,muted:!1,unmuted_color:"lime",queued:0,modes_l:["am","amn","usb","lsb","cw","cwn","nbfm","iq","drm","usn","lsn","sam","sal","sau","sas","qam"],modes_u:[],modes_s:{},RX4_WF4:0,RX8_WF2:1,RX3_WF3:2,RX14_WF0:3,cmap_s:["Kiwi","CuteSDR","grey","linear","turbo","SdrDx","custom 1","custom 2","custom 3","custom 4"],cmap_e:{kiwi:0,CuteSDR:1,greyscale:2,linear:3,turbo:4,SdrDx:5,custom_1:6,custom_2:7,custom_3:8,custom_4:9},aper_s:["man","auto"],aper_e:{man:0,auto:1}};kiwi.modes_l.forEach(function(e,i){kiwi.modes_u.push(e.toUpperCase()),kiwi.modes_s[e]=i});var rx_chans,wf_chans,wf_chans_real,rx_chan,max_camp,conn_type,timestamp,gmap,WATERFALL_CALIBRATION_DEFAULT=-13,SMETER_CALIBRATION_DEFAULT=-13,try_again="",seriousError=!1,types=["active","watch-list","sub-band","DGPS","special event","interference","masked"],types_s={active:0,watch_list:1,sub_band:2,DGPS:3,special_event:4,interference:5,masked:6},type_colors={0:"cyan",16:"lightPink",32:"aquamarine",48:"lavender",64:"violet",80:"violet",96:"lightGrey"},optbar_prefix_color="w3-text-css-orange",dbgUs=!1,dbgUsFirst=!0;function kiwi_bodyonload(e){if(""!=e)kiwi_serious_error(e);else{initCookie("ident","").startsWith("ZL/KF6VO")&&(dbgUs=!0),"undefined"==(conn_type=html("id-kiwi-container").getAttribute("data-type"))&&(conn_type="kiwi"),console.log("conn_type="+conn_type),w3int_init();var i=new Date;timestamp=i.getTime(),extint.ws="kiwi"==conn_type?owrx_ws_open_snd(kiwi_open_ws_cb,{conn_type:conn_type}):kiwi_ws_open(conn_type,kiwi_open_ws_cb,{conn_type:conn_type})}}function kiwi_open_ws_cb(e){"kiwi"!=e.conn_type&&setTimeout(function(){setInterval(function(){ext_send("SET keepalive")},5e3)},5e3),seriousError||ext_hasCredential(e.conn_type,kiwi_valpwd1_cb,e)}function kiwi_load_js_polled(e,i){return e.started||(kiwi_load_js(i,function(){e.finished=!0}),e.started=!0,e.finished=!1),e.finished}function kiwi_load_js_dir(e,i,t,r){for(var o=0;o<i.length;o++)i[o]=e+i[o];kiwi_load_js(i,t,r)}function kiwi_load_js(e,i,t){console.log("DYNLOAD START"),e.push("kiwi/kiwi_js_load.js"),console.log(e);var r=!1;e.forEach(function(t){if(kiwi.loaded_files[t])console.log("already loaded: "+t);else{if(t.includes("kiwi_js_load.js")){if(!r)return}else kiwi.loaded_files[t]=1,r=!0;var o,n=!1;t.endsWith(".js")||t.includes("/js?key=")?((o=document.createElement("script")).src=t,o.type="text/javascript","kiwi/kiwi_js_load.js"==t&&(o.kiwi_js=e[0],o.kiwi_cb=i)):t.endsWith(".css")?((o=document.createElement("link")).rel="stylesheet",o.href=t,o.type="text/css"):n=!0,n?console.log("UNKNOWN FILETYPE "+t):(o.async=!1,document.head.appendChild(o),console.log("loading "+t))}}),console.log("DYNLOAD FINISH"),r?t&&w3_call(t,!0):(t&&w3_call(t,!1),i&&w3_call(i))}function kiwi_ask_pwd_cb(e,i,t){ext_valpwd(conn_type,i)}function kiwi_queue_or_camp_cb(e,i,t){var r=window.location.href;console.log(r),r+=kiwi_add_search_param(window.location,"camp"),console.log("--\x3e "+r),window.location.href=r}function kiwi_ask_pwd(e){console.log("kiwi_ask_pwd chan_no_pwd_true="+chan_no_pwd_true+" client_public_ip="+client_public_ip);var i="",t="";e&&chan_no_pwd_true&&(i="All channels busy that don't require a password ("+chan_no_pwd_true+"/"+rx_chans+")<br>",t="<br> <b>OR</b> <br><br> click to queue for an available channel, <br>or camp on an existing channel: <br>"+w3_button("w3-medium w3-padding-smaller w3-aqua w3-margin-T-8","Queue or Camp","kiwi_queue_or_camp_cb")),kiwi_url_param(["p","prot","protected"],!0,!1)&&e&&(i="You have requested a password protected channel<br>"),kiwi_show_msg("KiwiSDR: software-defined receiver <br>"+i+try_again+w3_input("w3-retain-input-focus w3-margin-TB-8/w3-label-inline w3-label-not-bold/kiwi-pw|padding:1px|size=40","Password:","id-pwd","","kiwi_ask_pwd_cb")+t),w3_field_select("id-pwd",{mobile:1})}var override_freq,override_mode,override_zoom,override_max_dB,override_min_dB,override_9_10,body_loaded=!1;function kiwi_valpwd1_cb(e,i){if(!seriousError)if(1==e)kiwi_ask_pwd("kiwi"==i.conn_type),try_again="Try again. ";else{if(2==e)return void kiwi_show_msg("Still determining local interface address.<br>Please try reloading page in a few moments.");if(3==e)return void kiwi_show_msg("Admin connections not allowed from this ip address.");if(4==e)return void kiwi_show_msg("No admin password set. Can only connect from same local network as Kiwi.<br>Client ip = "+client_public_ip);if(5==e)return void kiwi_show_msg("Multiple connections from the same ip address not allowed.<br>Client ip = "+client_public_ip);0==e&&("kiwi"==i.conn_type?extint.ws=owrx_ws_open_wf(kiwi_open_ws_cb2,i):kiwi_valpwd2_cb(0,i))}}function kiwi_open_ws_cb2(e){ext_hasCredential(e.conn_type,kiwi_valpwd2_cb,e)}function kiwi_valpwd2_cb(e,i){if(!seriousError)if(kiwi_show_msg(""),body_loaded)console.log("kiwi_valpwd2_cb: body_loaded previously!");else{body_loaded=!0,"kiwi"!=i.conn_type&&(w3_hide("id-kiwi-msg-container"),w3_show_block("id-kiwi-container"),w3_el("id-kiwi-body").style.overflow="hidden");try{kiwi_init(),w3_call(i.conn_type+"_main")}catch(e){console.log("EX: "+e),console.log("kiwi_valpwd2_cb: no interface routine for "+i.conn_type+"?")}}}function kiwi_init(){}function kiwi_xdLocalStorage_init(){if(dbgUs){for(var e=[],i=0;i<5;i++)e[i]=dbgUs&&0==i?"http://kiwisdr.com/pkgs/xdLocalStorage/xdLocalStorage-min.html":"http://pub"+i+".kiwisdr.com:8073/pkgs/xdLocalStorage/xdLocalStorage-min.html";xdLocalStorageHA.init({iframeUrls:e,initCallback:function(){console.log("xdLocalStorageHA READY")}})}}function kiwi_get_init_settings(){var e=null==init_frequency?7020:init_frequency;e=ext_get_cfg_param("init.freq",e,EXT_NO_SAVE),init_frequency=override_freq||e;var i=null==init_mode?kiwi.modes_s.lsb:kiwi.modes_s[init_mode];i=ext_get_cfg_param("init.mode",i,EXT_NO_SAVE),init_mode=override_mode||kiwi.modes_l[i],"drm"===init_mode&&(init_mode="am");var t=null==init_zoom?0:init_zoom;t=ext_get_cfg_param("init.zoom",t,EXT_NO_SAVE),init_zoom=override_zoom||t;var r=null==init_max_dB?-10:init_max_dB;r=ext_get_cfg_param("init.max_dB",r,EXT_NO_SAVE),init_max_dB=override_max_dB||r;var o=null==init_min_dB?-110:init_min_dB;o=ext_get_cfg_param("init.min_dB",o,EXT_NO_SAVE),init_min_dB=override_min_dB||o,console.log("INIT f="+init_frequency+" m="+init_mode+" z="+init_zoom+" min="+init_min_dB+" max="+init_max_dB),w3_call("init_scale_dB");var n=ext_get_cfg_param("rx_antenna"),s=w3_el("rx-antenna");null!=s&&n&&(s.innerHTML="Antenna: "+decodeURIComponent(n)),kiwi.WSPR_rgrid=ext_get_cfg_param_string("WSPR.grid","",EXT_NO_SAVE)}var cfg={},adm={};function cfg_save_json(e,i){var t;null!=i&&null!=i&&(e.startsWith("adm.")?(t=encodeURIComponent(JSON.stringify(adm)),i.send("SET save_adm="+t)):(t=encodeURIComponent(JSON.stringify(cfg)),i.send("SET save_cfg="+t)),console.log("cfg_save_json: DONE"))}var server_time_utc,server_time_local,server_time_tzid,server_time_tzname,server_tz,geo={geo:"",json:"",retry:0};function kiwi_geolocate(e){var i=kiwi_isFirefox();if(!(i&&i<=28)){var t;switch(null==e&&(e=(new Date).getSeconds()),e%=3){case 0:t="ipapi.co/json";break;case 1:t="extreme-ip-lookup.com/json";break;case 2:t="get.geojs.io/v1/ip/geo.json"}kiwi_ajax("https://"+t,function(i){void 0===i.AJAX_error?(console.log("GEOLOC "+t),console.log(i),geoloc_json(i)):geo.retry++<=3&&kiwi_geolocate(e+1)},null,5e3)}}function geoloc_json(e){if(null==e.AJAX_error){window.JSON&&window.JSON.stringify?geo.json=JSON.stringify(e):geo.json=e.toString();var i=e.country_name||e.country;"United States"==i&&e.region&&(i=e.region+", USA"),geo.geo="",e.city&&(geo.geo+=e.city),i&&(geo.geo+=(e.city?", ":"")+i),console.log("GEOLOC "+geo.geo)}}function kiwi_geo(){return encodeURIComponent(geo.geo)}function kiwi_geojson(){return encodeURIComponent(geo.json)}var time_display_current=!0;function time_display_cb(e){isUndefined(e.tu)||(server_time_utc=e.tu,server_time_local=e.tl,server_time_tzid=decodeURIComponent(e.ti),server_time_tzname=decodeURIComponent(e.tn).replace(/\\/g,"").replace(/_/g," "),server_tz=server_time_tzname,server_time_tzid&&(server_tz+=" ("+server_time_tzid+")"),time_display_started?time_display(time_display_current):(time_display_periodic(),time_display_started=!0))}function time_display(e){if(w3_el("id-time-display-text-inner")){var i=""==server_time_local||"null"==server_time_tzname;w3_innerHTML("id-time-display-UTC",server_time_utc||"?"),w3_innerHTML("id-time-display-local",i?"?":server_time_local),w3_innerHTML("id-time-display-tzname",i?"Lat/lon needed for local time":server_tz),w3_el("id-time-display-logo-inner").style.opacity=e?0:1,w3_el("id-time-display-inner").style.opacity=e?1:0}}function time_display_periodic(){time_display(time_display_current),time_display_current^=1,setTimeout(function(){time_display_periodic()},time_display_current?5e4:1e4)}var time_display_prev,time_display_started=!1;function time_display_setup(e){var i;0==e.startsWith("id-")&&(e+="-time-display"),time_display_prev&&(i=w3_el(time_display_prev))&&(i.innerHTML=""),time_display_prev=e,(i=w3_el(e)).innerHTML=w3_div("id-time-display-inner",w3_div("id-time-display-text-inner",w3_inline("",w3_div("id-time-display-UTC"),w3_div("cl-time-display-text-suffix","UTC")),w3_inline("",w3_div("id-time-display-local"),w3_div("cl-time-display-text-suffix","Local")),w3_div("id-time-display-tzname")))+w3_div("id-time-display-logo-inner",w3_div("id-time-display-logo-text","Powered by"),'<a href="https://github.com/ha7ilm/openwebrx" target="_blank"><img id="id-time-display-logo" src="gfx/openwebrx-top-logo.png" /></a>'),time_display(time_display_current)}function time_display_width(){return 200}function time_display_html(e){return w3_div(e+"-time-display|top:50px; background-color:black; position:relative;")}var perf_status_anim,perf_status_timeout,pref={},pref_default={p:"default-p"};function show_pref(){pref_load(function(){var e=w3_divs("w3-text-css-yellow/w3-tspace-16",w3_div("w3-medium w3-text-aqua","<b>User preferences</b>"),w3_col_percent("",w3_input("","Pref","pref.p",pref.p,"pref_p_cb","something"),30),w3_div("w3-show-inline-block w3-hspace-16",w3_button("","Export","pref_export_btn_cb"),w3_button("","Import","pref_import_btn_cb"),"<b>Status:</b> "+w3_div("id-pref-status w3-show-inline-block w3-snap-back")));extint_panel_hide(),ext_panel_set_name("show_pref"),ext_panel_show(e,null,show_pref_post),ext_set_controls_width_height(1024,250),freqset_select()})}function pref_p_cb(e,i){w3_string_cb(e,i),pref_save()}function pref_refresh_ui(){w3_set_value("pref.p",pref.p)}function pref_status(e,i){var t=w3_el("id-pref-status");if(perf_status_anim)return kiwi_clearTimeout(perf_status_timeout),w3_remove_then_add(t,"w3-fade-out","w3-snap-back"),void setTimeout(function(){perf_status_anim=!1,pref_status(e,i)},1e3);t.style.color=e,t.innerHTML=i,w3_remove_then_add(t,"w3-snap-back","w3-fade-out"),perf_status_anim=!0,perf_status_timeout=setTimeout(function(){t.innerHTML="",w3_remove_then_add(t,"w3-fade-out","w3-snap-back"),perf_status_anim=!1},1500)}function pref_export_btn_cb(e,i){console.log("pref_export_btn_cb"),pref_save(function(){console.log("msg_send pref_export"),msg_send("SET pref_export id="+encodeURIComponent(pref.id)+" pref="+encodeURIComponent(JSON.stringify(pref)))}),pref_status("lime","preferences exported")}function pref_import_btn_cb(e,i){console.log("pref_import_btn_cb");var t=ident_user||"_blank_";msg_send("SET pref_import id="+encodeURIComponent(t))}function pref_import_cb(e,i){var t=decodeURIComponent(e);if(console.log("pref_import_cb "+t),"null"!=t){var r=kiwi_JSON_parse("pref_import_cb",t);r&&(pref=r,console.log(pref),pref_save(),pref_refresh_ui(),pref_status("lime","preferences successfully imported from RX"+i))}else pref_status("yellow","no preferences previously exported")}function pref_load(e){var i=ident_user||"_blank_";xdLocalStorageHA.getItem("pref."+i,function(t){if(console.log("xdLocalStorage.getItem pref."+i),console.log(t),null==t.value)pref=pref_default;else{var r=kiwi_JSON_parse("pref_load",t.value);r&&(pref=r)}console.log(pref),e&&e()})}function pref_save(e){var i=ident_user||"_blank_";pref.id=i;var t=JSON.stringify(pref);xdLocalStorageHA.setItem("pref."+i,t,function(t){console.log("xdLocalStorage.setItem pref."+i),console.log(t),e&&e()})}function show_pref_post(){console.log("show_pref_post")}function show_pref_blur(){console.log("show_pref_blur")}var ansi={colors:[[0,0,0],[194,54,33],[37,188,36],[173,173,39],[73,46,225],[211,56,211],[51,187,200],[203,204,205],[129,131,131],[252,57,31],[49,231,34],[234,236,35],[88,51,255],[249,53,248],[20,240,240],[233,235,235]]};function kiwi_output_msg(e,i,t){var r=w3_el(e);if(r){var o;try{o=decodeURIComponent(t.s)}catch(e){console.log("decodeURIComponent FAIL:"),console.log(t.s),o=t.s}t.init||(t.el=w3_create_appendElement(r,"pre",""),t.esc={s:"",state:0},t.sgr={span:0,bright:0,fg:null,bg:null},t.init=!0);var n="",s=w3_el(i),_=null;isUndefined(t.tstr)&&(t.tstr=""),isUndefined(t.col)&&(t.col=0),!t.process_return_alone||"\r"!=o.charAt(0)||1!=o.length&&"\n"==o.charAt(1)||(o=o.substring(1),t.tstr=n="",t.col=0),t.remove_returns&&(o=o.replace(/\r/g,""));for(var a=0;a<o.length;a++){var c=o.charAt(a);if("\f"==c){for(;r.firstChild;)r.removeChild(r.firstChild);t.el=w3_create_appendElement(r,"pre",""),t.tstr=n="",t.col=0}else if("\t"==c)for(n+="&nbsp;",t.col++;0!=(7&t.col);)n+="&nbsp;",t.col++;else if(""==c)t.esc.s="",t.esc.state=1;else if(1==t.esc.state)if(c<"@"||"["==c)t.esc.s+=c;else{t.esc.s+=c;var l=t.esc.s.charAt(0),d=t.esc.s.charAt(1),p=0;if("["==l)if("m"==c){for(var w,f=0,m=0,u=t.esc.s.substr(1).split(";"),g=u.length,k=0;k<g&&0==p;k++)if(0==(w=""==u[k]||"m"==u[k]?0:parseInt(u[k])))t.sgr.fg=t.sgr.bg=null,f=1;else if(isNaN(w))p=2;else if(1==w)t.sgr.bright=8;else if(2==w)t.sgr.bright=0;else if(22==w)t.sgr.bright=0;else if(7==w){var b=t.sgr.fg;t.sgr.fg=t.sgr.bg,t.sgr.bg=b,null==t.sgr.fg&&(t.sgr.fg=[255,255,255]),null==t.sgr.bg&&(t.sgr.bg=[0,0,0]),m=1}else if(27==w)t.sgr.fg=t.sgr.bg=null,m=1;else if(w>=30&&w<=37)t.sgr.fg=ansi.colors[w-30+t.sgr.bright],m=1;else if(w>=90&&w<=97)t.sgr.fg=ansi.colors[w-90+8],m=1;else if(39==w)t.sgr.fg=null,m=1;else if(w>=40&&w<=47)t.sgr.bg=ansi.colors[w-40+t.sgr.bright],m=1;else if(w>=100&&w<=107)t.sgr.bg=ansi.colors[w-100+8],m=1;else if(49==w)t.sgr.bg=null,m=1;else if(38==w||48==w){var v,h,x,y,S,T;3!=g||5!=parseInt(u[1])||isNaN(v=parseInt(u[2]))?5!=g||2!=parseInt(u[1])||isNaN(h=parseInt(u[2]))||isNaN(x=parseInt(u[3]))||isNaN(y=parseInt(u[4]))?p=2:(S=[h=w3_clamp(h,0,255),x=w3_clamp(x,0,255),y=w3_clamp(y,0,255)],38==w?t.sgr.fg=S:t.sgr.bg=S,m=1):(k+=2,v<=15?(S=ansi.colors[v],38==w?t.sgr.fg=S:t.sgr.bg=S,m=1):v<=231?(v-=16,v-=36*(h=Math.floor(v/36)),y=v-=6*(x=Math.floor(v/6)),S=[h=Math.floor(255*h/5),x=Math.floor(255*x/5),y=Math.floor(255*y/5)],38==w?t.sgr.fg=S:t.sgr.bg=S,m=1):v<=255?(S=[T=8+10*(v-232),T,T],38==w?t.sgr.fg=S:t.sgr.bg=S,m=1):p=2)}else p=2;f?t.sgr.span&&(n+="</span>",t.sgr.span=0):m?(t.sgr.span&&(n+="</span>"),n+='<span style="'+(t.sgr.fg?"color:"+kiwi_rgb(t.sgr.fg)+";":"")+(t.sgr.bg?"background-color:"+kiwi_rgb(t.sgr.bg)+";":"")+'">',t.sgr.span=1):p=2}else"K"==c?p="erase in line":"P"==c?p="del # chars":"?"==d?p="set/reset mode":"r"==c||(p="l"==c?"reset mode":"J"==c?"2"==d||"3"==d?"erase whole display":"1"==d?"erase start to cursor":2:"H"==c?"move row,col":"d"==c?"move row":"G"==c?"move col":2);else"("==l||(p=2);1===p?console.log("ESC "+JSON.stringify(t.esc.s)+" IGNORED"):2===p?console.log("ESC "+JSON.stringify(t.esc.s)+" UNKNOWN"):isString(p)&&console.log("ESC "+JSON.stringify(t.esc.s)+" "+p),t.esc.state=0}else(c>=" "&&c<="~"||"\n"==c)&&("<"==c?(n+="&lt;",t.col++):">"==c?(n+="&gt;",t.col++):("\n"!=c&&(n+=c,t.col++),"\n"!=c&&t.col!=t.ncol||(_=kiwi_isScrolledDown(s),t.tstr+=n,""==t.tstr&&(t.tstr="&nbsp;"),t.el.innerHTML=t.tstr,t.tstr=n="",t.el=w3_create_appendElement(r,"pre",""),t.col=0,w3_contains(s,"w3-scroll-down")&&(!t.scroll_only_at_bottom||t.scroll_only_at_bottom&&_)&&(s.scrollTop=s.scrollHeight))))}_=kiwi_isScrolledDown(s),t.tstr+=n,t.el.innerHTML=t.tstr,w3_contains(s,"w3-scroll-down")&&(!t.scroll_only_at_bottom||t.scroll_only_at_bottom&&_)&&(s.scrollTop=s.scrollHeight)}else console.log("kiwi_output_msg NOT_FOUND id="+e)}function gps_stats_cb(e,i,t,r,o,n){var s=(e?"yes":"pause")+", track "+i+", good "+t+", fixes "+r.toUnits();if(w3_innerHTML("id-msg-gps","GPS: acquire "+s),w3_innerHTML("id-status-gps",w3_text(optbar_prefix_color,"GPS"),w3_text("","acq "+s)),extint_adc_clock_Hz=1e6*o,extint_adc_gps_clock_corr=n,n){s=o.toFixed(6)+" ("+n.toUnits()+" avgs)";var _=w3_el("id-msg-gps");_&&(_.innerHTML+=", ADC clock "+s),w3_innerHTML("id-status-adc",w3_text(optbar_prefix_color,"ADC clock "),w3_text("",s))}}function admin_stats_cb(e,i,t,r,o,n,s,_){if(null!=e){var a=w3_el("id-msg-errors");if(a&&(a.innerHTML="Stats: "+e.toUnits()+" dropped, "+i.toUnits()+" underruns, "+t.toUnits()+" sequence, "+r.toUnits()+" realtime"),a=w3_el("id-status-dp-hist")){for(var c="Datapump: ",l=0;l<o;l++)c+=(l?", ":"")+n[l].toUnits();a.innerHTML=c}if(a=w3_el("id-status-in-hist")){for(c="SoundInQ: ",l=0;l<s;l++)c+=(l?", ":"")+_[l].toUnits();a.innerHTML=c}}}function kiwi_too_busy(e){kiwi_show_msg("Sorry, the KiwiSDR server is too busy right now ("+e+' users max). <br>There is also a limit on the total number of channel queuers and campers. <br>Please check <a href="http://rx.kiwisdr.com" target="_self">rx.kiwisdr.com</a> for more KiwiSDR receivers available world-wide.')}function kiwi_exclusive_use(){kiwi_show_msg('Sorry, this Kiwi has been locked for special use. <br>This happens when using an extension (e.g. DRM decoder) that requires all available resources. <br>Please check <a href="http://rx.kiwisdr.com" target="_self">rx.kiwisdr.com</a> for more KiwiSDR receivers available world-wide. <br><br>Áî≥„ÅóË®≥„ÅÇ„Çä„Åæ„Åõ„Çì„Åå„ÄÅ„Åì„ÅÆ„Ç≠„Éº„Ç¶„Ç£„ÅØÁâπÂà•„Å™‰ΩøÁî®„ÅÆ„Åü„ÇÅ„Å´„É≠„ÉÉ„ÇØ„Åï„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ <br>„Åì„Çå„ÅØ„ÄÅÂà©Áî®ÂèØËÉΩ„Å™„Åô„Åπ„Å¶„ÅÆ„É™„ÇΩ„Éº„Çπ„ÇíÂøÖË¶Å„Å®„Åô„ÇãÊã°ÂºµÊ©üËÉΩÔºàDRM „Éá„Ç≥„Éº„ÉÄ„Éº„Å™„Å©Ôºâ„Çí‰ΩøÁî®„Åó„Å¶„ÅÑ„ÇãÂ†¥Âêà„Å´Áô∫Áîü„Åó„Åæ„Åô„ÄÇ <br>‰∏ñÁïå‰∏≠„ÅßÂà©Áî®„Åß„Åç„Çã KiwiSDR „É¨„Ç∑„Éº„Éê„Éº„Å´„Å§„ÅÑ„Å¶„ÅØ„ÄÅ<a href="http://rx.kiwisdr.com" target="_self">rx.kiwisdr.com</a> „ÇíÁ¢∫Ë™ç„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ')}function kiwi_ip_limit_pwd_cb(e){console.log("kiwi_ip_limit_pwd_cb pwd="+e),writeCookie("iplimit",encodeURIComponent(e)),window.location.reload(!0)}function kiwi_show_error_ask_exemption_cb(e,i,t){kiwi_ip_limit_pwd_cb(i)}function kiwi_show_error_ask_exemption(e){kiwi_show_msg(e+="<br><br>If you have an exemption password from the KiwiSDR owner/admin <br> please enter it here: "+w3_input("w3-retain-input-focus w3-margin-TB-8/w3-label-inline w3-label-not-bold/kiwi-pw|padding:1px|size=40","Password:","id-epwd","","kiwi_show_error_ask_exemption_cb")),w3_field_select("id-epwd",{mobile:1})}function kiwi_inactivity_timeout(e){kiwi_show_msg("Sorry, this KiwiSDR has an inactivity timeout after "+e+" minutes.<br>Reload the page to continue.")}function kiwi_24hr_ip_limit(e,i){kiwi_show_error_ask_exemption("Sorry, this KiwiSDR can only be used for "+e+' minutes every 24 hours by each IP address.<br>Please check <a href="http://rx.kiwisdr.com" target="_self">rx.kiwisdr.com</a> for more KiwiSDR receivers available world-wide.')}function kiwi_password_entry_timeout(){kiwi_show_msg("Timeout. Please reload page to continue.")}function kiwi_up(e){seriousError||(w3_hide("id-kiwi-msg-container"),w3_show_block("id-kiwi-container"),w3_el("id-kiwi-body").style.overflow="hidden")}function kiwi_down(e,i,t){var r;1==(e=+e)?(r='Sorry, software update in progress. Please check back in a few minutes.<br>Or check <a href="http://rx.kiwisdr.com" target="_self">rx.kiwisdr.com</a> for more KiwiSDR receivers available world-wide.',i>0&&i<9e3?r+="<br>Build: compiling file #"+i:9997==i?r+="<br>Build: linking":9998==i?r+="<br>Build: installing":9999==i&&(r+="<br>Build: done")):2==e?r="Backup in progress.":(null!=t&&""!=t||(t='Sorry, this KiwiSDR server is being used for development right now. <br>Please check <a href="http://rx.kiwisdr.com" target="_self">rx.kiwisdr.com</a> for more KiwiSDR receivers available world-wide.'),r=t),kiwi_show_msg(r)}var stats_interval=1e4,need_config=!0;function stats_init(){need_config&&(msg_send("SET GET_CONFIG"),need_config=!1),stats_update()}function stats_update(){msg_send("SET STATS_UPD ch="+rx_chan);var e=new Date,i=Math.ceil(e/stats_interval)*stats_interval-e;i<stats_interval/2&&(i+=stats_interval),setTimeout(stats_update,i)}function status_periodic(){w3_innerHTML("id-status-stats-cpu",kiwi_cpu_stats_str),w3_innerHTML("id-status-stats-xfer",kiwi_xfer_stats_str),w3_innerHTML("id-msg-stats-cpu",kiwi_cpu_stats_str_long),w3_innerHTML("id-msg-stats-xfer",kiwi_xfer_stats_str_long)}var kiwi_xfer_stats_str="",kiwi_xfer_stats_str_long="";function xfer_stats_cb(e,i,t,r,o){kiwi_xfer_stats_str=w3_text(optbar_prefix_color,"Net")+w3_text("","aud "+e.toFixed(0)+", wf "+i.toFixed(0)+", http "+r.toFixed(0)+", total "+o.toFixed(0)+" kB/s"),kiwi_xfer_stats_str_long="Network (all channels): audio "+e.toFixed(0)+" kB/s, waterfall "+i.toFixed(0)+" kB/s ("+t.toFixed(0)+" fps), http "+r.toFixed(0)+" kB/s, total "+o.toFixed(0)+" kB/s ("+(8*o).toFixed(0)+" kb/s)"}var kiwi_cpu_stats_str="",kiwi_cpu_stats_str_long="",kiwi_config_str="",kiwi_config_str_long="";function cpu_stats_cb(e,i,t,r){d%=100;var o=e.cc?e.cc:0,n=9*o/5+32,s=e.cc?e.cc>=60?"w3-text-css-red w3-bold":e.cc>=50?"w3-text-css-yellow":"w3-text-css-lime":"",_=o?o.toFixed(0)+"&deg;C "+n.toFixed(0)+"&deg;F ":"",a=e.cf>=1e3?(e.cf/1e3).toFixed(1)+" GHz":e.cf.toFixed(0)+" MHz";kiwi_cpu_stats_str=w3_text(optbar_prefix_color,"BB ")+w3_text("",e.cu[0]+","+e.cs[0]+","+e.ci[0]+" usi% ")+(o?w3_text(s,_):"")+w3_text("",a+" ")+w3_text(optbar_prefix_color,"FPGA")+w3_text("",t.toFixed(0)+"%"),kiwi.wf_fps=r;for(var c="",l="",d="",p=!0,w=0;w<e.cu.length;w++)c+=(p?"":" ")+e.cu[w]+"%",l+=(p?"":" ")+e.cs[w]+"%",d+=(p?"":" ")+e.ci[w]+"%",p=!1;var f="cpu";if(e.cu.length>1){f+="0";for(w=1;w<e.cu.length;w++)f+=" cpu"+w}kiwi_cpu_stats_str_long=w3_inline("",w3_text("w3-text-black","Beagle: "+f+" "+c+" usr | "+l+" sys | "+d+" idle,"+(o?"":" "))+(o?"&nbsp;"+w3_text(s+" w3-text-outline w3-large",_)+"&nbsp;":"")+w3_text("w3-text-black",a+", ")+w3_text("w3-text-black","FPGA eCPU: "+t.toFixed(0)+"%"));var m=i,u=Math.trunc(m%60);m=Math.trunc(m/60);var g=Math.trunc(m%60);m=Math.trunc(m/60);var k=Math.trunc(m%24),b=m=Math.trunc(m/24),v=" ";b&&(v+=b+"d:"),v+=k+":"+g.leadingZeros(2)+":"+u.leadingZeros(2),w3_innerHTML("id-status-config",w3_text(optbar_prefix_color,"Up"),w3_text("",v+", "+kiwi_config_str)),v=" | Uptime: ",b&&(v+=b+" "+(b>1?"days":"day")+" "),v+=k+":"+g.leadingZeros(2)+":"+u.leadingZeros(2);var h=""==server_time_local||"null"==server_time_tzname;server_time_utc&&(v+=" | UTC: "+server_time_utc),isDefined(server_time_tzname)&&(v+=" | Local: ",h||(v+=server_time_local+" "),v+=h?"Lat/lon needed for local time":server_tz),w3_innerHTML("id-msg-config",kiwi_config_str_long+v)}function config_str_update(e,i,t,r){kiwi_config_str="v"+t+"."+r+", "+e+" SDR ch, "+i+" GPS ch",w3_innerHTML("id-status-config",kiwi_config_str),kiwi_config_str_long="Config: v"+t+"."+r+", "+e+" SDR channels, "+i+" GPS channels",w3_innerHTML("id-msg-config",kiwi_config_str)}var config_net={};function config_cb(e,i,t,r,o,n,s,_,a,c,l){config_str_update(e,i,c,l);var d=w3_el("id-net-config");d&&(d.innerHTML=w3_div("",w3_col_percent("",w3_div("","Public IP address (outside your firewall/router): "+r+" [port "+o+"]"),50,w3_div("","Ethernet MAC address: "+a.toUpperCase()),30,w3_div("","KiwiSDR serial number: "+t),20),w3_col_percent("",w3_div("","Private IP address (inside your firewall/router): "+n+" [port "+s+"]"),50,w3_div("","Private netmask: /"+_),50)),config_net.pub_ip=r,config_net.pub_port=o,config_net.pvt_ip=r,config_net.pvt_port=s,config_net.mac=a,config_net.serno=t)}function update_cb(e,i,t,r,o,n,s,_,a,c,l){config_str_update(r,o,n,s);var d,p=w3_el("id-msg-update");p&&(d="Installed version: v"+n+"."+s+", built "+c+" "+l,d+=e?"<br>Cannot build, filesystem is FULL!":t?"<br>Update to version v"+ +_+"."+a+" in progress":i?"<br>Update check pending":-1==_?"<br>Error determining the latest version -- check log":n==_&&s==a?"<br>Running most current version":"<br>Available version: v"+_+"."+a,p.innerHTML=d)}var users_interval=2500,user_init=!1;function users_init(e){if(kiwi.called_from_admin=e.admin,kiwi.called_from_user=e.user,kiwi.called_from_monitor=e.monitor,kiwi.called_from_admin||kiwi.called_from_monitor)for(var i,t=kiwi.called_from_admin?"id-admin-user-":"id-monitor-user-",r=kiwi.called_from_monitor?" w3-padding-LR-2":"",o="",n=0;n<rx_chans;n++)kiwi.called_from_admin&&(o=w3_button("id-user-kick-"+n+" w3-small w3-white w3-border w3-border-red w3-round-large w3-padding-0 w3-padding-LR-8","Kick","status_user_kick_cb",n)),i=w3_div("id-campers-"+n+" w3-css-orange w3-padding-LR-8"),w3_el("id-users-list").innerHTML+=w3_inline("/w3-hspace-8",w3_div("id-user-"+n+r,"RX"+n),w3_div(t+n),o,i);users_update(),w3_call("users_setup"),user_init=!0}function users_update(){msg_send("SET GET_USERS"),setTimeout(users_update,users_interval)}function user_cb(e){var i=kiwi.called_from_admin?"id-admin-user-":"id-monitor-user-",t=kiwi_url_origin();e.forEach(function(e){var r="",o="",n=e.i,s=e.n,_=e.f,a=e.g,c=isDefined(e.a)&&""!=e.a?e.a+", ":"",l=e.m,d=e.z,p=e.t,w="";if(e.rt){var f=1==e.rt?" act":" 24h";w=" "+w3_text("w3-text-css-orange|vertical-align:bottom",e.rs+f)}var m=e.e;if(isDefined(s)){var u,g=!1;do{try{u=decodeURIComponent(s),g=!0}catch(e){s=s.slice(0,-1)}}while(!g);var k=kiwi_strip_tags(u,"");""!=k&&(k='"'+k+'" ');var b="(null)"==a||""==a?"unknown location":decodeURIComponent(a);b="("+(c=c.replace(/::ffff:/,""))+b+") ";var v,h,x=(v=((v=_+1e3*cfg.freq_offset)/1e3).toFixed(v>1e8?1:2))+" kHz ",y=(_/1e3).toFixed(2);kiwi.called_from_admin?(h=t+"/?f="+y+l+"z"+d,' target="_blank"'):(h="javascript:"+(kiwi.called_from_user?"tune("+y+","+sq(l)+","+d+")":"camp("+n+")"),""),""!=m&&(m=decodeURIComponent(m)+" "),r=k+b,o=w3_link("w3-link-darker-color",h,x+l+" z"+d)+" "+m+p+w}if(user_init)if(kiwi.called_from_user)w3_innerHTML("id-optbar-user-"+n,""!=r?r+"<br>"+o:"");else{w3_innerHTML(i+n,r+o+"");var S="id-user-kick-"+n;w3_el(S)&&(""!=r?w3_show_inline_block(S):w3_hide(S))}if(n==rx_chan&&isDefined(e.c)){var T=w3_el("id-sam-carrier");T&&w3_innerHTML(T,"carrier "+e.c.toFixed(1)+" Hz")}if(w3_innerHTML("id-campers-"+n,e.ca?e.ca+plural(e.ca," camper"):""),n==rx_chan&&e.rn&&e.rn<=55&&!kiwi.inactivity_panel){var I="Inactivity timeout in one minute.<br>Close this panel to avoid disconnection.";confirmation_show_content(I,350,55,function(){msg_send("SET inactivity_ack"),confirmation_panel_close(),kiwi.inactivity_panel=!1},"red"),kiwi.inactivity_panel=!0}if(n==rx_chan&&e.rn>55&&kiwi.inactivity_panel&&(confirmation_panel_close(),kiwi.inactivity_panel=!1),n==rx_chan&&isNumber(e.fo)&&e.fo!=cfg.freq_offset&&!confirmation.displayed){I=w3_div("","Frequency scale offset changed. Page must be reloaded.",w3_inline("w3-halign-space-around/",w3_button("w3-margin-T-16 w3-aqua","OK","freq_offset_page_reload")));confirmation_show_content(I,425,100)}})}function freq_offset_page_reload(){window.location.reload(!0)}var toggle_e={SET:1,SET_URL:2,FROM_COOKIE:4,WRITE_COOKIE:8};function kiwi_toggle(e,i,t,r){var o=null;if(e&toggle_e.SET_URL&&(null!=i||null!=i))o=i;else if(e&toggle_e.FROM_COOKIE&&null!=(o=readCookie(r))){var n=parseFloat(o);isNaN(n)||(o=n)}return null==o&&e&toggle_e.SET&&(o=i),null==o&&(o=t),o}function kiwi_plot_max(e){var i=bi[e];return 1024/(i.samplerate/i.plot_samplerate)}function kiwi_fft_mode(){setmaxdb(-30)}function kiwi_mapPinSymbol(e,i){return{path:"M 0,0 C -2,-20 -10,-22 -10,-30 A 10,10 0 1,1 10,-30 C 10,-22 2,-20 0,0 z",fillColor:e=e||"red",fillOpacity:1,strokeColor:i=i||"white",strokeWeight:1,scale:1}}var comp_ctr,chan_no_pwd,chan_no_pwd_true,pref_import_ch,client_public_ip,reason_disabled="",version_maj=-1,version_min=-1,tflags={INACTIVITY:1,WF_SM_CAL:2,WF_SM_CAL2:4},kiwi_output_msg_p={scroll_only_at_bottom:!0,process_return_alone:!1};function kiwi_msg(e,i){var t=!0;switch(e[0]){case"version_maj":version_maj=parseInt(e[1]);break;case"version_min":version_min=parseInt(e[1]);break;case"client_public_ip":client_public_ip=e[1].replace(/::ffff:/,""),console.log("client public IP: "+client_public_ip);break;case"badp":console.log("badp="+e[1]),extint_valpwd_cb(parseInt(e[1]));break;case"chan_no_pwd":chan_no_pwd=parseInt(e[1]);break;case"chan_no_pwd_true":chan_no_pwd_true=parseInt(e[1]);break;case"rx_chans":rx_chans=parseInt(e[1]);break;case"wf_chans":wf_chans=parseInt(e[1]);break;case"wf_chans_real":wf_chans_real=parseInt(e[1]);break;case"rx_chan":rx_chan=parseInt(e[1]);break;case"max_camp":max_camp=parseInt(e[1]);break;case"load_cfg":var r=decodeURIComponent(e[1]);cfg=kiwi_JSON_parse("load_cfg",r),owrx_cfg();break;case"load_adm":var o=decodeURIComponent(e[1]);adm=kiwi_JSON_parse("load_adm",o);break;case"request_dx_update":dx_update();break;case"mkr":(n=kiwi_JSON_parse("mkr",e[1]))&&dx_label_cb(n);break;case"user_cb":var n;(n=kiwi_JSON_parse("user_cb",e[1]))&&user_cb(n);break;case"config_cb":(s=kiwi_JSON_parse("config_cb",e[1]))&&config_cb(s.r,s.g,s.s,s.pu,s.pe,s.pv,s.pi,s.n,s.m,s.v1,s.v2,s.ai);break;case"update_cb":(s=kiwi_JSON_parse("update_cb",e[1]))&&update_cb(s.f,s.p,s.i,s.r,s.g,s.v1,s.v2,s.p1,s.p2,decodeURIComponent(s.d),decodeURIComponent(s.t));break;case"stats_cb":var s;(s=kiwi_JSON_parse("stats_cb",e[1]))&&(null!=s.ce&&cpu_stats_cb(s,s.ct,s.ce,s.fc),xfer_stats_cb(s.ac,s.wc,s.fc,s.ah,s.as),extint_srate=s.sr,gps_stats_cb(s.ga,s.gt,s.gg,s.gf,s.gc,s.go),s.gr&&(kiwi.WSPR_rgrid=decodeURIComponent(s.gr),kiwi.GPS_fixes=s.gf),-1==s.sh?(w3_innerHTML("id-rx-snr",", SNR ",s.sa," dB"),w3_innerHTML("id-msg-snr","SNR: All ",s.sa," dB")):(w3_innerHTML("id-rx-snr",", SNR ",s.sa,":",s.sh," dB"),w3_innerHTML("id-msg-snr","SNR: All ",s.sa," dB, HF ",s.sh," dB")),admin_stats_cb(s.ad,s.au,s.ae,s.ar,s.an,s.ap,s.an2,s.ai),time_display_cb(s));break;case"status_msg_text":kiwi_output_msg_p.s=e[1],kiwi_output_msg("id-output-msg","id-output-msg",kiwi_output_msg_p);break;case"status_msg_html":var _=decodeURIComponent(e[1]);w3_innerHTML("id-status-msg",_),w3_innerHTML("id-msg-status",_);break;case"is_admin":extint_isAdmin_cb(e[1]);break;case"is_local":var a=e[1].split(",");console.log("kiwi_msg rx_chan="+a[0]+" is_local="+a[1]),kiwi.is_local[+a[0]]=+a[1];break;case"is_multi_core":kiwi.is_multi_core=1;break;case"authkey_cb":extint_authkey_cb(e[1]);break;case"down":kiwi_down(e[1],comp_ctr,reason_disabled);break;case"too_busy":kiwi_too_busy(parseInt(e[1]));break;case"monitor":kiwi_monitor();break;case"exclusive_use":kiwi_exclusive_use();break;case"inactivity_timeout":kiwi_inactivity_timeout(e[1]);break;case"ip_limit":a=decodeURIComponent(e[1]).split(",");kiwi_24hr_ip_limit(parseInt(a[0]),a[1]);break;case"password_timeout":kiwi_password_entry_timeout();break;case"comp_ctr":comp_ctr=e[1];break;case"reason_disabled":reason_disabled=decodeURIComponent(e[1]);break;case"sample_rate":extint_srate=parseFloat(e[1]);break;case"pref_import_ch":pref_import_ch=+e[1];break;case"pref_import":pref_import_cb(e[1],pref_import_ch);break;case"adc_clk_nom":extint_adc_clock_nom_Hz=+e[1];break;default:t=!1}return t}function kiwi_debug(e){console.log(e),msg_send("SET dbug_msg="+encodeURIComponent(e))}function kiwi_show_msg(e){html("id-kiwi-msg").innerHTML=e,""==e?(w3_hide("id-kiwi-msg-container"),w3_el("id-kiwi-body").style.overflow="hidden"):(w3_hide("id-kiwi-container"),w3_show_block("id-kiwi-msg-container"),w3_el("id-kiwi-body").style.overflow="scroll")}function kiwi_server_error(e){kiwi_show_msg('Hmm, there seems to be a problem. <br>The server reported the error: <span style="color:red">'+e+"</span>"),seriousError=!0}function kiwi_serious_error(e){kiwi_show_msg(e),seriousError=!0,console.log(e)}function kiwi_trace(e){e&&console.log("kiwi_trace: "+e);try{console.trace()}catch(e){}}function kiwi_trace_mobile(e){alert(e+" "+Error().stack)}


