

/* web/extensions/FSK/CCIR476.min.js (web/extensions/FSK/CCIR476.js = Sun May 12 10:49:17 2024) */
function CCIR476(){var t=this;t.start_bit=1;console.log('FSK encoder: CCIR476');t.code_character32=0x6a;t.LETTERS=0x5a;t.FIGURES=0x36;t.code_alpha=0x0f;t.code_beta=0x33;t.code_char32=0x6a;t.code_rep=0x66;t.char_bell=0x07;t.valid_codes=[];t.code_ltrs=[];t.ltrs_code=[];t.code_figs=[];t.figs_code=[];t.shift=false;t.alpha_phase=false;t.strict_mode=false;var BEL='\07';var ALF=BET=FGS=LTR=REP=C32='_';t.ltrs=['_','_','_','_','_','_','_','_','_','_','_','_','_','_','_',ALF,'_','_','_','_','_','_','_','J','_','_','_','F','_','C','K','_','_','_','_','_','_','_','_','W','_','_','_','Y','_','P','Q','_','_','_','_',BET,'_','G',FGS,'_','_','M','X','_','V','_','_','_','_','_','_','_','_','_','_','A','_','_','_','S','_','I','U','_','_','_','_','D','_','R','E','_','_','N',LTR,'_',' ','_','_','_','_','_','_','Z','_','L',REP,'_','_','H',C32,'_','\n','_','_','_','_','O','B','_','T','_','_','_','\r','_','_','_','_','_','_','_'];t.figs=['_','_','_','_','_','_','_','_','_','_','_','_','_','_','_',ALF,'_','_','_','_','_','_','_','\'','_','_','_','!','_',':','(','_','_','_','_','_','_','_','_','2','_','_','_','6','_','0','1','_','_','_','_',BET,'_','&',FGS,'_','_','.','/','_',';','_','_','_','_','_','_','_','_','_','_','-','_','_','_',BEL,'_','8','7','_','_','_','_','$','_','4','3','_','_',',',LTR,'_',' ','_','_','_','_','_','_','"','_',')',REP,'_','_','#',C32,'_','\n','_','_','_','_','9','?','_','5','_','_','_','\r','_','_','_','_','_','_','_'];for(var code=0;code<128;code++){if(t.check_bits(code)){t.valid_codes[code]=true;var ltrv=t.ltrs[code];if(ltrv!='_'){t.code_ltrs[code]=ltrv;t.ltrs_code[ltrv]=code;}
var figv=t.figs[code];if(figv!='_'){t.code_figs[code]=figv;t.figs_code[figv]=code;}}}}
CCIR476.prototype.reset=function(){this.shift=false;}
CCIR476.prototype.get_nbits=function(){return 7;}
CCIR476.prototype.get_msb=function(){return 0x40;}
CCIR476.prototype.code_to_char=function(code,shift){var t=this;var ch=shift?t.code_figs[code]:t.code_ltrs[code];if(ch==undefined)
ch=-code;return ch;}
CCIR476.prototype.check_bits=function(v){var _v=v;var bc=0;while(v!=0){bc++;v&=v-1;}
return bc==4;}
CCIR476.prototype.process_char=function(code,fixed_start,cb){var t=this;var success=t.check_bits(code);var tally=0;var chr=-1;if(code==t.code_rep){t.alpha_phase=false;}else if(code==t.code_alpha){t.alpha_phase=true;}
if(!t.alpha_phase){t.c1=t.c2;t.c2=t.c3;t.c3=code;}else{if(t.strict_mode){if(success&&t.c1==code){chr=code;}}else{if(success){chr=code;}else if(t.check_bits(t.c1)){chr=t.c1;}}
if(chr==-1){tally=-1;}else{tally=1;switch(chr){case t.code_rep:break;case t.code_alpha:break;case t.code_beta:break;case t.code_char32:break;case t.LETTERS:t.shift=false;break;case t.FIGURES:t.shift=true;break;default:chr=t.code_to_char(chr,t.shift);if(chr<0){console.log('missed this code: 0x'+Math.abs(chr).toString(16));}else{cb(chr.toString());}
break;}}}
t.alpha_phase=!t.alpha_phase;return{success:success,tally:tally};}



