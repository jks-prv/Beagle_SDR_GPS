

/* web/extensions/timecode/msf.min.js */
var msf={arm:0,NOISE_THRESHOLD:3,cur:0,sec:0,msec:0,dcnt:0,line:0,end:null};function msf_dmsg(t){w3_innerHTML("id-tc-msf",t)}function msf_legend(){0==(3&msf.line++)&&tc_dmsg("1 uuuuuuuuuuuuuuuu yyyyyyyy mmmmm dddddd www hhhhhh mmmmmmm 01111110<br>")}function msf_decode(t){var c=tc_bcd(t,51,7,-1),e=tc_bcd(t,44,6,-1),d=tc_bcd(t,35,6,-1),n=(tc_bcd(t,38,3,-1),tc_bcd(t,29,5,-1)-1),m=tc_bcd(t,24,8,-1)+2e3;tc_dmsg("  "+d+" "+tc.mo[n]+" "+m+" "+e.leadingZeros(2)+":"+c.leadingZeros(2)+" UTC<br>"),tc_stat("lime","Time decoded: "+d+" "+tc.mo[n]+" "+m+" "+e.leadingZeros(2)+":"+c.leadingZeros(2)+" UTC")}function msf_clr(){var t=msf;t.cur=t.cnt=t.one_width=t.zero_width=0,t.arm=t.no_modulation=t.dcnt=t.modct=t.line=t.sec=t.msec=0}function msf_ampl(t){var c=msf;if(tc.trig++,tc.trig>=100&&(tc.trig=0),t=t>.5?1:0,tc.ref||(tc.data=t,tc.ref=1),t==c.cur?c.cnt=0:(c.cnt++,c.cnt>c.NOISE_THRESHOLD&&(c.cur=t,c.cnt=0,tc.data^=1,tc.data?c.one_width=0:c.zero_width=0)),tc.data?c.one_width++:c.zero_width++,tc.state==tc.ACQ_SYNC&&0==c.arm&&c.zero_width>=40&&(c.arm=1,c.zero_width=0),1==c.arm&&c.one_width>=40&&tc.data&&(c.arm=2,c.one_width=0),2==c.arm&&0==tc.data&&(tc.trig=0,tc.sample_point=25,c.sec=0,c.msec=0,tc.state==tc.ACQ_SYNC&&tc_stat("cyan","Found sync"),msf_legend(),tc.raw=[],tc.state=tc.MIN_MARK,c.arm=0),tc.state==tc.MIN_MARK||tc.state==tc.ACQ_DATA&&tc.sample_point==tc.trig){var e=tc.state==tc.MIN_MARK||c.zero_width>15?1:0;tc.raw[c.sec]=e,tc.state==tc.MIN_MARK&&(c.msec=990,tc.state=tc.ACQ_DATA),tc_dmsg(e),[0,16,24,29,35,38,44,51].includes(c.dcnt)&&tc_dmsg(" "),c.dcnt++,60==c.dcnt&&(msf_decode(tc.raw),msf_legend(),tc.raw=[],c.sec=-1,c.dcnt=0)}c.msec+=10,1e3==c.msec&&(c.sec++,c.msec=0)}function msf_focus(){}function msf_blur(){var t;(t=w3_el("id-tc-bits"))&&(t.innerHTML=""),(t=w3_el("id-tc-msf"))&&(t.innerHTML="")}function msf_init(){w3_el("id-tc-addon").innerHTML+=w3_div("id-tc-bits")+w3_div("id-tc-msf")}


