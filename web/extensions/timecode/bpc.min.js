

/* web/extensions/timecode/bpc.min.js */
var bpc={arm:0,NOISE_THRESHOLD:3,cur:0,sec:0,msec:0,dcnt:0,line:0,prev:[],raw:[],chr:0,tod:0,time:0,dibit:["00","01","10","11"],end:null};function bpc_dmsg(t){w3_innerHTML("id-tc-bpc",t)}function bpc_legend(){0==(3&bpc.line)&&tc_dmsg("ss hhhhhh mmmmmm ????Pp dddddd mmmm yyyyyy ?? <br>")}function bpc_decode(t){var c=16*t[1]+4*t[2]+t[3];c<=11?(2&t[9]&&(c+=12),c=c.leadingZeros(2)):c="??";var e=16*t[4]+4*t[5]+t[6];e=e>59?"??":e.leadingZeros(2);var d=t[0];d=d>2?"??":(20*d).leadingZeros(2);var n=16*t[10]+4*t[11]+t[12];n=0==n||n>31?"??":n.fieldWidth(2);var i=4*t[13]+t[14];i=0==i||i>12?"???":tc.mo[i-1];for(var r=16*t[15]+4*t[16]+t[17]+2e3,a=0,_=0;_<19;_++)a+=[0,1,1,2][t[_]];var s=n+" "+i+" "+r+" "+c+":"+e+":"+d+" CST",o=(a&=1)?"PARITY ERROR":"";tc_dmsg("   "+s+"  "+o+"<br>"),tc_stat("lime","Time decoded: "+(a?o:s))}function bpc_clr(){var t=bpc;t.cur=t.cnt=t.one_width=t.zero_width=0,t.arm=t.no_modulation=t.dcnt=t.modct=t.line=t.sec=t.msec=0,tc.trig=0,tc.state=tc.ACQ_SYNC,null!=server_time_local&&""!=server_time_local&&(t.time=3600*parseInt(server_time_local)+60*parseInt(server_time_local.substr(3))+60),t.tod=t.time}function bpc_ampl(t){var c=bpc;if(tc.trig++,tc.trig>=100&&(tc.trig=0),t=t>.5?1:0,tc.ref||(tc.data=1^t,tc.ref=1),t==c.cur)c.cnt=0;else if(c.cnt++,c.cnt>c.NOISE_THRESHOLD)if(c.cur=t,c.cnt=0,tc.data_last=tc.data,tc.data^=1,tc.data){if(tc.state!=tc.ACQ_SYNC){var e=Math.round((c.zero_width-9)/10);e>=4&&(e=0),c.raw[c.dcnt]=e;var d=c.dibit[e];e!=c.prev[c.dcnt]&&c.line&&(d='<span style="color:lime">'+d+"</span>"),c.prev[c.dcnt]=e,tc_dmsg(d),[0,3,6,9,12,14,17].includes(c.dcnt)&&tc_dmsg(" "),c.dcnt++,c.dcnt>=19&&(bpc_decode(c.raw),c.dcnt=0,c.line++,bpc_legend())}c.one_width=0}else c.zero_width=0;tc.data?c.one_width++:c.zero_width++,tc.state==tc.ACQ_SYNC&&0==c.arm&&c.one_width>=170&&(c.arm=1,c.one_width=0),1==c.arm&&1==tc.data_last&&0==tc.data&&(c.arm=2,tc.state=tc.MIN_MARK,tc.trig=0,tc.sample_point=40,bpc_legend(),tc_stat("cyan","Found sync")),c.msec+=10,1e3==c.msec&&(c.sec++,c.msec=0)}function bpc_focus(){}function bpc_blur(){var t;(t=w3_el("id-tc-bits"))&&(t.innerHTML=""),(t=w3_el("id-tc-bpc"))&&(t.innerHTML="")}function bpc_init(){w3_el("id-tc-addon").innerHTML+=w3_div("id-tc-bits")+w3_div("id-tc-bpc")}


